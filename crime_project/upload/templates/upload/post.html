<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style type="text/css">
        .img_wrap {
            width: 300px;
            margin-top: 50px;
        }
        .img_wrap img {
            max-width: 100%;
        }
    </style>


    <script src='https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js'></script>
    <script type="text/javascript">
        
        var sel_file;

        $(document).ready(function() {
            $("#input_img").on("change", handleImgFileSelect);
        }); 

        function handleImgFileSelect(e) {
            var files = e.target.files;
            var filesArr = Array.prototype.slice.call(files);
            var fileSize = files[0]['size']
            console.log(fileSize)

            filesArr.forEach(function(f) {
                if(!f.type.match("image.*")) {
                    alert("이미지 파일만 업로드할 수 있습니다.");
                    return;
                }

                sel_file = f;

                var reader = new FileReader();
                reader.onload = function(e) {
                    $("#img").attr("src", e.target.result);
                }
                reader.readAsDataURL(f);
            });
            document.getElementById("fileSize").innerHTML = fileSize;
            return fileSize;
        }


        function send() {
            alert("send")
            document.getElementById('contents').submit();
        }
    </script>

</head>
<body>
    <form action="{% url 'upload:result' %}" id='contents' method="post" enctype="multipart/form-data">
        {% csrf_token %}
        id : <input name='id' type="text">
        pw : <input name='name' type="text">
        <h2><b>이미지 업로드</b></h2>
        <input type="file" name="input_img" id="input_img" /> <br><br>
        <span name="fileSize" id="fileSize">0</span>
        <button type="button" onclick="send();">데이터보내기</button> <br>
    </form>

    <div>
        <div class="img_wrap">
            <img id="img" />
        </div>
    </div>

</body>
</html>



